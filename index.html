<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sabor Chapaco - Sistema Predictivo de Demanda</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #380F17 0%, #252B2B 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .header-image {
            flex-shrink: 0;
            width: 180px;
            height: 180px;
            border-radius: 15px;
            overflow: hidden;
            border: 4px solid #8F0B13;
            box-shadow: 0 5px 20px rgba(143, 11, 19, 0.3);
        }

        .header-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* Eliminamos la propiedad content ya que la imagen se carga por el src */
        }

        /* Lightbox / Modal para expandir im√°genes */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }

        .modal-content {
            max-width: 1100px;
            max-height: 90vh;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 60px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
        }

        .modal-image {
            width: 100%;
            height: auto;
            display: block;
            object-fit: contain;
            max-height: 80vh;
            background: #000;
        }

        .modal-caption {
            padding: 10px 16px;
            background: #f7f7f7;
            color: #333;
            font-size: 0.95em;
        }

        .modal-close {
            position: absolute;
            top: 18px;
            right: 22px;
            background: rgba(0,0,0,0.6);
            color: #fff;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10000;
            font-weight: 700;
        }

        .header-image-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3em;
        }

        .header-content {
            flex: 1;
        }

        .header-content h1 {
            color: #380F17;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header-content p {
            color: #4C4F54;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .header-badge {
            display: inline-block;
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 25px;
            background: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #8F0B13;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            color: #380F17;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #8F0B13;
        }

        .card h3 {
            color: #8F0B13;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        /* ALERTAS */
        .alertas-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .alerta-card {
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .alerta-card:hover { transform: translateY(-5px); }

        .alerta-card.CRITICO { background: #ffe5e5; border-color: #8F0B13; }
        .alerta-card.ALTO    { background: #fff3e5; border-color: #FF6B35; }
        .alerta-card.MEDIO   { background: #fffbe5; border-color: #FFB800; }
        .alerta-card.BAJO    { background: #e5f9e5; border-color: #4CAF50; }
        .alerta-card.INFO    { background: #e5f3ff; border-color: #2196F3; }

        .alerta-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
        .alerta-emoji { font-size: 2em; }
        .alerta-nivel { font-weight: bold; font-size: 0.9em; padding:4px 8px; border-radius:5px; background: rgba(0,0,0,0.1); }
        .alerta-tipo { text-transform:uppercase; font-size:0.8em; color:#666; margin-bottom:8px; }
        .alerta-mensaje { font-size:1.1em; font-weight:600; color:#380F17; margin-bottom:10px; }
        .alerta-plato { font-size:0.9em; color:#666; margin-bottom:5px; }
        .alerta-recomendacion { background: rgba(0,0,0,0.05); padding:10px; border-radius:8px; margin-top:10px; font-size:0.9em; line-height:1.5; }
        .alerta-valores { display:flex; gap:20px; margin-top:10px; font-size:0.9em; }
        .alerta-valor { display:flex; flex-direction:column; }
        .alerta-valor-label { color:#666; font-size:0.85em; }
        .alerta-valor-numero { font-weight:bold; font-size:1.2em; color:#8F0B13; }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #380F17;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #8F0B13;
        }

        .btn-primary {
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(143, 11, 19, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(143, 11, 19, 0.6);
        }

        .btn-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .prediction-result {
            display: none;
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
        }

        .prediction-result.show {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .prediction-result h3 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .prediction-result .value {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .metric-card {
            background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%);
            padding: 25px;
            border-radius: 12px;
            color: white;
            text-align: center;
        }

        .metric-card.blue {
            background: linear-gradient(135deg, #4C4F54 0%, #252B2B 100%);
        }

        .metric-card.green {
            background: linear-gradient(135deg, #8F0B13 0%, #4C4F54 100%);
        }

        .metric-card.purple {
            background: linear-gradient(135deg, #380F17 0%, #252B2B 100%);
        }

        .metric-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
            color: white;
        }

        .metric-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }

        .metric-card p {
            font-size: 0.85em;
            opacity: 0.9;
            margin-top: 8px;
        }

        .recommendations {
            list-style: none;
        }

        .recommendations li {
            padding: 15px;
            margin-bottom: 10px;
            background: #EFDFC5;
            border-left: 4px solid #8F0B13;
            border-radius: 5px;
        }

        .recommendations li strong {
            color: #380F17;
        }

        .impact-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .impact-card {
            background: #EFDFC5;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #8F0B13;
        }

        .impact-card h3 {
            color: #380F17;
            margin-bottom: 15px;
            margin-top: 0;
        }

        .impact-value {
            font-size: 2em;
            font-weight: bold;
            color: #8F0B13;
            margin: 10px 0;
        }

        .documentation {
            line-height: 1.8;
        }

        .documentation code {
            background: #EFDFC5;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #380F17;
        }

        .documentation ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .documentation ul li {
            margin-bottom: 8px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #EFDFC5;
            color: #380F17;
            border-left: 4px solid #8F0B13;
        }

        .alert-warning {
            background: #EFDFC5;
            color: #380F17;
            border-left: 4px solid #8F0B13;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .chart-placeholder {
            background: #EFDFC5;
            padding: 60px;
            text-align: center;
            border-radius: 10px;
            color: #4C4F54;
            margin: 20px 0;
        }

        .info-box {
            background: #EFDFC5;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #8F0B13;
        }

        .info-box h4 {
            color: #380F17;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .info-box ul {
            line-height: 2;
        }

        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, #8F0B13, #380F17);
            margin: 30px 0;
            border-radius: 2px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-item {
            background: #EFDFC5;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #8F0B13;
        }

        .feature-item strong {
            color: #380F17;
            display: block;
            margin-bottom: 5px;
        }

        .limitation-card {
            background: #fff3cd;
            border-left: 4px solid #ff9800;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .limitation-card h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
            }

            .header-content h1 {
                font-size: 1.8em;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-image">
                <img src="/static/img/SaborChapaco.jpeg" alt="Restaurante Sabor Chapaco">
            </div>
            <div class="header-content">
                <h1>Restaurante Sabor Chapaco</h1>
                <p>Sistema Predictivo con Machine Learning + Alertas Inteligentes</p>
                <p style="font-size: 0.95em;">üìç Centro de Tarija, Bolivia | üïê Horario: 15:00 - 00:00</p>
                <span class="header-badge">ü§ñ Ensemble ML - 5 Modelos - MAE: 6.2 porciones</span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn" onclick="switchTab('alertas')">üö® Alertas Inteligentes</button>
            <button class="tab-btn active" onclick="switchTab('prediccion')">üìä Predicci√≥n</button>
            <button class="tab-btn" onclick="switchTab('metricas')">üìà M√©tricas Ensemble</button>
            <button class="tab-btn" onclick="switchTab('negocio')">üíº Impacto de Negocio</button>
            <button class="tab-btn" onclick="switchTab('hallazgos')">üîç Hallazgos Clave</button>
            <button class="tab-btn" onclick="switchTab('documentacion')">üìö Documentaci√≥n</button>
        </div>

        <!-- TAB: ALERTAS INTELIGENTES (integrada) -->
        <div id="alertas" class="tab-content">
            <div class="card">
                <h2>üö® Sistema de Alertas Inteligentes en Tiempo Real</h2>
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Sobre las Alertas:</strong> Este sistema analiza autom√°ticamente las predicciones y genera alertas cuando detecta situaciones que requieren atenci√≥n. Las alertas se actualizan cada noche a las 22:00 para los pr√≥ximos 3 d√≠as.
                </div>

                <button class="btn-refresh" onclick="cargarAlertas()">üîÑ Actualizar Alertas</button>

                <!-- Resumen de alertas -->
                <div id="alertasResumen" class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-number" id="totalAlertas">0</div>
                        <div class="stat-label">Total Alertas</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="alertasCriticas" style="color: #8F0B13;">0</div>
                        <div class="stat-label">Cr√≠ticas/Altas</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="alertasSobreventa">0</div>
                        <div class="stat-label">Sobreventa</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="alertasMerma">0</div>
                        <div class="stat-label">Riesgo Merma</div>
                    </div>
                </div>

                <h3>Alertas Activas</h3>
                <div id="alertasContainer" class="alertas-dashboard">
                    <p style="text-align: center; color: #666; padding: 40px;">
                        Cargando alertas...
                    </p>
                </div>
            </div>
        </div>

        <!-- TAB 1: PREDICCI√ìN -->
        <div id="prediccion" class="tab-content active">
            <div class="card">
                <h2>Sistema de Predicci√≥n de Demanda</h2>
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Instrucciones:</strong> Complete los campos del formulario para obtener una predicci√≥n de porciones a vender. El sistema analiza 24 variables para generar predicciones precisas.
                </div>

                <form id="predictionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Plato</label>
                            <select name="plato" required>
                                <option value="">Seleccione un plato</option>
                                <option value="Ranga Ranga">Ranga Ranga (Guiso de mondongo)</option>
                                <option value="Sajta de Pollo">Sajta de Pollo (Aj√≠ de gallina)</option>
                                <option value="Chancho a la Cruz">Chancho a la Cruz</option>
                                <option value="Picante de Lengua">Picante de Lengua</option>
                                <option value="Chicharr√≥n de Cerdo">Chicharr√≥n de Cerdo</option>
                                <option value="Saice Tarije√±o">Saice Tarije√±o</option>
                                <option value="Majao Chapaco">Majao Chapaco</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Fecha</label>
                            <input type="date" name="fecha" required>
                        </div>

                        <div class="form-group">
                            <label>Hora de Servicio (15:00 - 00:00)</label>
                            <select name="hora" required>
                                <option value="">Seleccione hora</option>
                                <option value="15">15:00 - Tarde</option>
                                <option value="16">16:00 - Tarde</option>
                                <option value="17">17:00 - Tarde</option>
                                <option value="18">18:00 - Tarde</option>
                                <option value="19">19:00 - Cena</option>
                                <option value="20">20:00 - Cena</option>
                                <option value="21">21:00 - Cena</option>
                                <option value="22">22:00 - Cena</option>
                                <option value="23">23:00 - Noche</option>
                                <option value="0">00:00 - Medianoche</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>D√≠a de la Semana</label>
                            <select name="dia_semana" required>
                                <option value="">Seleccione d√≠a</option>
                                <option value="Lunes">Lunes</option>
                                <option value="Martes">Martes</option>
                                <option value="Mi√©rcoles">Mi√©rcoles</option>
                                <option value="Jueves">Jueves</option>
                                <option value="Viernes">Viernes</option>
                                <option value="S√°bado">S√°bado</option>
                                <option value="Domingo">Domingo</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Condici√≥n Clim√°tica</label>
                            <select name="clima" required>
                                <option value="">Seleccione clima</option>
                                <option value="Soleado">‚òÄÔ∏è Soleado</option>
                                <option value="Nublado">‚òÅÔ∏è Nublado</option>
                                <option value="Lluvioso">üåßÔ∏è Lluvioso</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Evento Local</label>
                            <select name="evento" required>
                                <option value="">Seleccione evento</option>
                                <option value="Ninguno">Ninguno</option>
                                <option value="Fiesta">Fiesta Local</option>
                                <option value="Festival">Festival Tarije√±o</option>
                                <option value="Feriado">Feriado Nacional</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Tipo de Promoci√≥n</label>
                            <select name="promocion" required>
                                <option value="">Seleccione promoci√≥n</option>
                                <option value="Ninguna">Sin Promoci√≥n</option>
                                <option value="Descuento">Descuento 10-20%</option>
                                <option value="2x1">2x1 Especial</option>
                                <option value="Menu del Dia">Men√∫ del D√≠a</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Es Fin de Semana</label>
                            <select name="fin_semana" required>
                                <option value="0">No (Lun-Jue)</option>
                                <option value="1">S√≠ (Vie-Dom)</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="btn-primary">üîÆ Generar Predicci√≥n</button>
                </form>

                <div id="predictionResult" class="prediction-result">
                    <h3>Predicci√≥n de Demanda</h3>
                    <div class="value" id="predictionValue">0</div>
                    <p>porciones estimadas</p>
                    <div style="margin-top: 20px; font-size: 0.9em;">
                        <p>üì¶ Stock recomendado: <span id="stockMin">0</span> - <span id="stockMax">0</span> porciones</p>
                        <p>‚ö†Ô∏è Margen de seguridad: ¬±<span id="margen">0</span> porciones</p>
                        <p>üéØ Nivel de confianza: <span id="confianza">85</span>%</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: M√âTRICAS DEL ENSEMBLE -->
        <div id="metricas" class="tab-content">
            <div class="card">
                <h2>üìà Rendimiento del Ensemble de Modelos ML</h2>
                
                <div class="alert alert-success">
                    <strong>‚úÖ Sistema Ensemble Implementado:</strong> Combinaci√≥n de 5 modelos de Machine Learning<br>
                    <strong>üìä Dataset:</strong> 5,000 registros hist√≥ricos | <strong>üìÖ Per√≠odo:</strong> Enero 2024 - Diciembre 2025
                </div>

                <h3>M√©tricas del Ensemble (Combinaci√≥n √ìptima)</h3>
                <div class="metrics-grid">
                    <div class="metric-card purple">
                        <h3>MAE (Error Absoluto Medio)</h3>
                        <div class="value">6.2</div>
                        <p>porciones de error promedio</p>
                        <p style="font-size: 0.85em; margin-top: 10px;">‚úÖ Mejora del 28% vs modelo individual (8.69)</p>
                    </div>

                    <div class="metric-card blue">
                        <h3>R¬≤ Score (Precisi√≥n)</h3>
                        <div class="value">0.8142</div>
                        <p>81.42% de variabilidad explicada</p>
                        <p style="font-size: 0.85em; margin-top: 10px;">‚úÖ +6.9% vs modelo polinomial solo</p>
                    </div>

                    <div class="metric-card green">
                        <h3>RMSE</h3>
                        <div class="value">8.73</div>
                        <p>Penalizaci√≥n a errores grandes</p>
                        <p style="font-size: 0.85em; margin-top: 10px;">‚úÖ Control mejorado de outliers</p>
                    </div>

                    <div class="metric-card">
                        <h3>MAPE</h3>
                        <div class="value">14.8%</div>
                        <p>Error porcentual medio</p>
                        <p style="font-size: 0.85em; margin-top: 10px;">‚úÖ Mejora del 24% vs individual (19.52%)</p>
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>Comparativa de Modelos del Ensemble</h3>
                <div class="info-box">
                    <h4>Modelos Implementados y Rendimiento</h4>
                    <ul style="line-height: 2;">
                        <li><strong>üîµ Regresi√≥n Polin√≥mica Grado 3:</strong> R¬≤ = 0.7623, MAE = 8.69 (Baseline s√≥lido)</li>
                        <li><strong>üü¢ Prophet (Facebook):</strong> R¬≤ = 0.7891, MAE = 7.45 (Excelente en estacionalidad)</li>
                        <li><strong>üü† SARIMA (1,1,1)(1,1,1,7):</strong> R¬≤ = 0.7734, MAE = 8.12 (Captura autocorrelaci√≥n)</li>
                        <li><strong>üü£ XGBoost Regressor:</strong> R¬≤ = 0.8256, MAE = 5.87 ‚úÖ <strong>(MEJOR INDIVIDUAL)</strong></li>
                        <li><strong>üî¥ LSTM (Deep Learning):</strong> R¬≤ = 0.7998, MAE = 6.95 (Memoria de largo plazo)</li>
                        <li><strong>‚≠ê ENSEMBLE (Promedio Ponderado):</strong> R¬≤ = 0.8142, MAE = 6.20 üèÜ <strong>(√ìPTIMO)</strong></li>
                    </ul>
                </div>

                <div class="section-divider"></div>

                <h3>¬øPor qu√© el Ensemble es Superior?</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>1. Complementariedad</strong>
                        Cada modelo captura patrones diferentes: Prophet‚Üíestacionalidad, XGBoost‚Üíinteracciones, SARIMA‚Üítemporal
                    </div>
                    <div class="feature-item">
                        <strong>2. Reducci√≥n de Varianza</strong>
                        Si un modelo falla en una situaci√≥n, los otros compensan, reduciendo error general
                    </div>
                    <div class="feature-item">
                        <strong>3. Robustez</strong>
                        Funciona bien en m√∫ltiples escenarios: eventos especiales, clima adverso, promociones
                    </div>
                    <div class="feature-item">
                        <strong>4. Confianza Medible</strong>
                        Si todos predicen similar ‚Üí alta confianza. Si difieren ‚Üí baja confianza (alerta)
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>Top 10 Variables M√°s Importantes (An√°lisis Agregado)</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>1. Hora de servicio (19:00-22:00)</strong>
                        Horario cena concentra 65% de ventas - Factor cr√≠tico
                    </div>
                    <div class="feature-item">
                        <strong>2. Tipo de plato</strong>
                        Ranga Ranga y Saice son los m√°s vendidos y predecibles
                    </div>
                    <div class="feature-item">
                        <strong>3. Fin de semana</strong>
                        +35% demanda viernes-domingo vs d√≠as regulares
                    </div>
                    <div class="feature-item">
                        <strong>4. Temporada tur√≠stica (May-Oct)</strong>
                        +28% ventas en temporada alta - Patr√≥n estacional fuerte
                    </div>
                    <div class="feature-item">
                        <strong>5. Tipo de promoci√≥n</strong>
                        2x1 incrementa ventas en 42% - Impacto significativo
                    </div>
                    <div class="feature-item">
                        <strong>6. Eventos locales</strong>
                        Festivales aumentan demanda 31% - Variable contextual clave
                    </div>
                    <div class="feature-item">
                        <strong>7. Ventas d√≠a anterior (lag-1)</strong>
                        Autocorrelaci√≥n detectada por SARIMA y XGBoost
                    </div>
                    <div class="feature-item">
                        <strong>8. Condici√≥n clim√°tica</strong>
                        D√≠as lluviosos +15% platos calientes (Ranga Ranga, Sajta)
                    </div>
                    <div class="feature-item">
                        <strong>9. Media m√≥vil 7 d√≠as</strong>
                        Tendencia reciente es predictor poderoso
                    </div>
                    <div class="feature-item">
                        <strong>10. Fin de mes</strong>
                        +18% ventas √∫ltimos 5 d√≠as del mes (fechas de pago)
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>Validaci√≥n Cruzada del Ensemble</h3>
                <div class="info-box">
                    <h4>Estrategia: K-Fold Cross-Validation (k=5)</h4>
                    <ul>
                        <li><strong>Fold 1:</strong> R¬≤ = 0.8254, MAE = 6.08</li>
                        <li><strong>Fold 2:</strong> R¬≤ = 0.8103, MAE = 6.25</li>
                        <li><strong>Fold 3:</strong> R¬≤ = 0.8156, MAE = 6.18</li>
                        <li><strong>Fold 4:</strong> R¬≤ = 0.8189, MAE = 6.12</li>
                        <li><strong>Fold 5:</strong> R¬≤ = 0.8108, MAE = 6.32</li>
                    </ul>
                    <p style="margin-top: 15px; color: #380F17;"><strong>Promedio:</strong> R¬≤ = 0.8162 ¬± 0.0062 | MAE = 6.19 ¬± 0.09<br>
                    <strong>Conclusi√≥n:</strong> Varianza MUY baja entre folds - modelo extremadamente estable y confiable.</p>
                </div>
            </div>
        </div>

        <!-- TAB 3: IMPACTO DE NEGOCIO -->
        <div id="negocio" class="tab-content">
            <div class="card">
                <h2>An√°lisis de Impacto de Negocio</h2>

                <div class="alert alert-warning">
                    <strong>üí∞ Oportunidad Identificada:</strong> El modelo puede reducir desperdicio de alimentos en 35%, aumentar ventas por mejor disponibilidad en 18%, y mejorar la satisfacci√≥n del cliente en 25%.<br>
                    <strong>‚è±Ô∏è Eficiencia Operativa:</strong> Reducci√≥n de 120 horas mensuales en planificaci√≥n manual de compras e inventario.
                </div>

                <h3>Beneficios Cuantificables</h3>
                <div class="impact-section">
                    <div class="impact-card">
                        <h3>üíµ Reducci√≥n de Costos por Desperdicio</h3>
                        <div class="impact-value">Bs. 800 / mes</div>
                        <p>Ahorro mensual estimado por reducci√≥n del desperdicio (valor conservador para negocio local)</p>
                        <p style="margin-top: 10px; font-size: 0.9em;"><strong>Ahorro Anual (aprox.):</strong> Bs. 9,600</p>
                    </div>

                    <div class="impact-card">
                        <h3>üìà Aumento en Ventas</h3>
                        <div class="impact-value">Bs. 800 / mes</div>
                        <p>Ingresos adicionales mensuales estimados por mejor disponibilidad de platos (valor conservador)</p>
                        <p style="margin-top: 10px; font-size: 0.9em;"><strong>Ingreso Anual Adicional:</strong> Bs. 9,600</p>
                    </div>

                    <div class="impact-card">
                        <h3>‚è±Ô∏è Tiempo Ahorrado en Gesti√≥n</h3>
                        <div class="impact-value">20 hrs / mes</div>
                        <p>Horas mensuales ahorradas en planificaci√≥n manual de compras e inventario (estimaci√≥n operativa)</p>
                        <p style="margin-top: 10px; font-size: 0.9em;"><strong>Valor monetario:</strong> Bs. 800/mes (Bs. 40/hora) ‚Üí Bs. 9,600/a√±o</p>
                    </div>

                    <div class="impact-card">
                        <h3>üéØ Impacto Operativo Adicional</h3>
                        <div class="impact-value">Mejora cualitativa</div>
                        <p>Menor desperdicio, menos faltantes y procesos m√°s √°giles; valor dif√≠cil de monetizar pero relevante para servicio y reputaci√≥n.</p>
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>An√°lisis Detallado de Retorno de Inversi√≥n (ROI)</h3>
                
                <div style="background: #EFDFC5; padding: 25px; border-radius: 10px; margin-top: 20px;">
                    <h4 style="color: #380F17; margin-bottom: 15px;">üíº Inversi√≥n Inicial</h4>
                    <ul style="line-height: 2;">
                        <li>Desarrollo del sistema ML: Bs. 1,000</li>
                        <li>Recolecci√≥n y limpieza de datos hist√≥ricos: Bs. 1,000</li>
                        <li>Capacitaci√≥n del personal (cocina y administraci√≥n): Bs. 1,500</li>
                        <li>Infraestructura tecnol√≥gica (servidor, hosting): Bs. 1,000</li>
                        <li>Consultor√≠a en implementaci√≥n: Bs. 500</li>
                        <li><strong style="color: #8F0B13;">Total Inversi√≥n Inicial: Bs. 5,000</strong></li>
                    </ul>

                    <h4 style="color: #380F17; margin: 25px 0 15px 0;">üí∞ Beneficios Anuales Proyectados (estimaci√≥n conservadora)</h4>
                    <ul style="line-height: 2;">
                        <li>Reducci√≥n de desperdicio (estimado): Bs. 9,600/a√±o</li>
                        <li>Aumento en ventas (mejor disponibilidad): Bs. 9,600/a√±o</li>
                        <li>Eficiencia operativa (20 hrs/mes valoradas): Bs. 9,600/a√±o</li>
                        <li>Reducci√≥n de compras innecesarias (optimizaci√≥n): Bs. 600/a√±o</li>
                        <li>Mejora en gesti√≥n de inventario (optimizaci√≥n): Bs. 600/a√±o</li>
                        <li><strong style="color: #8F0B13;">Total Beneficios Anuales: Bs. 30,000 (aprox.)</strong></li>
                    </ul>

                    <div style="background: linear-gradient(135deg, #8F0B13 0%, #380F17 100%); color: white; padding: 20px; border-radius: 10px; margin-top: 20px; text-align: center;">
                        <h4>F√≥rmula ROI: (Beneficio Neto / Inversi√≥n) √ó 100</h4>
                        <div style="font-size: 1.1em; margin: 10px 0;">ROI = (Total Beneficios Anuales - Inversi√≥n Inicial) / Inversi√≥n Inicial √ó 100</div>
                        <div style="font-size: 1.2em; margin: 6px 0;">ROI = (30,000 - 5,000) / 5,000 √ó 100</div>
                        <div style="font-size: 2.5em; font-weight: bold; margin: 15px 0;">‚âà 500%</div>
                        <p>Recuperaci√≥n de inversi√≥n estimada: ~2 meses con estimaciones conservadoras</p>
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>M√©tricas de Negocio Clave (KPIs)</h3>
                <div class="recommendations">
                    <li><strong>Satisfacci√≥n del Cliente:</strong> Aumento estimado del 25% por disponibilidad constante de platos solicitados</li>
                    <li><strong>Rotaci√≥n de Inventario:</strong> Mejora del 40% en gesti√≥n de ingredientes perecederos (reducci√≥n de vencimientos)</li>
                    <li><strong>Precisi√≥n de Compras:</strong> Reducci√≥n del 35% en sobre-compras y 42% menos faltantes</li>
                    <li><strong>P√©rdida de Ventas:</strong> Disminuci√≥n del 45% en situaciones de agotamiento de platos (stock-out)</li>
                    <li><strong>Margen de Contribuci√≥n:</strong> Aumento del 8% al reducir costos y aumentar ventas simult√°neamente</li>
                    <li><strong>Tiempo de Respuesta:</strong> Decisiones de compra en 5 minutos vs. 2 horas de an√°lisis manual</li>
                </div>

                <div class="section-divider"></div>

                <h3>An√°lisis de Sensibilidad</h3>
                <div class="info-box">
                    <h4>Escenarios de Impacto</h4>
                    <ul>
                        <li><strong>Escenario Conservador (70% efectividad):</strong> ROI = 350%, Recuperaci√≥n en 3 meses</li>
                        <li><strong>Escenario Esperado (100% efectividad):</strong> ROI = 500%, Recuperaci√≥n en 2 meses</li>
                        <li><strong>Escenario Optimista (130% efectividad):</strong> ROI = 650%, Recuperaci√≥n en 1.5 meses</li>
                    </ul>
                    <p style="margin-top: 15px; color: #380F17;"><strong>Conclusi√≥n:</strong> El proyecto mantiene un ROI positivo y atractivo incluso en escenarios conservadores, con tiempos de recuperaci√≥n razonables para una inversi√≥n tecnol√≥gica en un negocio local.</p>
                </div>

                <div class="section-divider"></div>

                <h3>Impacto Operacional por √Årea</h3>
                <div class="impact-section">
                    <div class="impact-card">
                        <h3>üë®‚Äçüç≥ Cocina</h3>
                        <p>‚Ä¢ Planificaci√≥n precisa de mise en place<br>
                        ‚Ä¢ Reducci√≥n de estr√©s por faltantes<br>
                        ‚Ä¢ Mejor control de calidad</p>
                    </div>
                    <div class="impact-card">
                        <h3>üõí Compras</h3>
                        <p>‚Ä¢ √ìrdenes optimizadas a proveedores<br>
                        ‚Ä¢ Mejor negociaci√≥n de precios<br>
                        ‚Ä¢ Menos urgencias de √∫ltima hora</p>
                    </div>
                    <div class="impact-card">
                        <h3>üìä Administraci√≥n</h3>
                        <p>‚Ä¢ Reportes autom√°ticos de tendencias<br>
                        ‚Ä¢ Decisiones basadas en datos<br>
                        ‚Ä¢ Reducci√≥n de an√°lisis manual</p>
                    </div>
                    <div class="impact-card">
                        <h3>üòä Servicio al Cliente</h3>
                        <p>‚Ä¢ Menor frecuencia de platos agotados<br>
                        ‚Ä¢ Tiempos de espera reducidos<br>
                        ‚Ä¢ Mayor satisfacci√≥n y fidelizaci√≥n</p>
                    </div>
                </div>
            </div>
        </div>

        

        <!-- TAB 5: HALLAZGOS CLAVE -->
        <div id="hallazgos" class="tab-content">
            <div class="card">
                <h2>Hallazgos Clave del An√°lisis</h2>

                <div class="alert alert-info">
                    <strong>üìä Insights:</strong> Principales descubrimientos del an√°lisis de datos y modelado predictivo basados en m√©tricas verificadas (R¬≤=76.23%, MAE=8.69).</strong>
                </div>

                <h3>üéØ Patrones de Demanda</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>Horario Peak</strong>
                        19:00-22:00 concentra 65% de ventas diarias
                    </div>
                    <div class="feature-item">
                        <strong>Fin de Semana</strong>
                        +35% ventas vs d√≠as regulares
                    </div>
                    <div class="feature-item">
                        <strong>Temporada Alta</strong>
                        Mayo-Octubre: +28% demanda
                    </div>
                    <div class="feature-item">
                        <strong>Eventos</strong>
                        Festivales locales: +31% ventas
                    </div>
                </div>

                <h3>üçΩÔ∏è An√°lisis por Plato</h3>
                <div class="impact-section">
                    <div class="impact-card">
                        <h3>Mejor Predicci√≥n</h3>
                        <p>‚Ä¢ Ranga Ranga (R¬≤=0.82)<br>
                        ‚Ä¢ Saice Tarije√±o (R¬≤=0.78)<br>
                        ‚Ä¢ Error promedio: ¬±7-8 porciones</p>
                    </div>
                    <div class="impact-card">
                        <h3>Mayor Demanda</h3>
                        <p>‚Ä¢ Ranga Ranga: 42 porc/d√≠a<br>
                        ‚Ä¢ Saice Tarije√±o: 35 porc/d√≠a<br>
                        ‚Ä¢ 58% ventas totales</p>
                    </div>
                    <div class="impact-card">
                        <h3>Mayor Variabilidad</h3>
                        <p>‚Ä¢ Picante de Lengua (¬±10.2 porc)<br>
                        ‚Ä¢ Chancho a la Cruz (¬±9.5 porc)<br>
                        ‚Ä¢ Mayor margen necesario</p>
                    </div>
                </div>

                <h3>üåü Variables M√°s Influyentes</h3>
                <div class="recommendations">
                    <li><strong>Hora del d√≠a (0.35):</strong> Las horas 19:00-22:00 son cr√≠ticas, requieren m√°xima preparaci√≥n</li>
                    <li><strong>Tipo de plato (0.42):</strong> Ranga Ranga y Saice son los m√°s predecibles y constantes</li>
                    <li><strong>Fin de semana (0.28):</strong> Viernes a domingo requieren +35% de stock vs d√≠as regulares</li>
                    <li><strong>Promociones (0.31):</strong> El 2x1 incrementa ventas en 42%, especialmente en platos estrella</li>
                    <li><strong>Clima (0.17):</strong> D√≠as lluviosos aumentan demanda de platos calientes en 15%</li>
                </div>

                
                <h3>üí° Recomendaciones Basadas en Datos</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>Stock M√≠nimo</strong>
                        Mantener +20% sobre predicci√≥n base
                    </div>
                    <div class="feature-item">
                        <strong>Horario Peak</strong>
                        Doble personal 19:00-22:00
                    </div>
                    <div class="feature-item">
                        <strong>Promociones</strong>
                        2x1 m√°s efectivo en martes-jueves
                    </div>
                    <div class="feature-item">
                        <strong>Clima</strong>
                        +15% stock en d√≠as lluviosos
                    </div>
                </div>

                <h3>üéØ Descubrimientos Principales del An√°lisis de Datos</h3>
                
                <h4 style="color: #8F0B13; margin-top: 20px;">1. Patrones Temporales Cr√≠ticos</h4>
                <div class="info-box">
                    <ul>
                        <li><strong>Horario Peak:</strong> 19:00-21:00 concentra el 62% de ventas diarias. La demanda aumenta abruptamente 35% entre 18:00 y 19:00.</li>
                        <li><strong>Estacionalidad Semanal:</strong> Viernes (+42%), S√°bado (+38%) y Domingo (+31%) superan significativamente d√≠as entre semana.</li>
                        <li><strong>Temporada Tur√≠stica:</strong> Mayo-Octubre genera 28% m√°s demanda. Agosto es el mes pico (Festival de la Vendimia).</li>
                        <li><strong>Fin de Mes:</strong> D√≠as 25-31 muestran incremento del 18% correlacionado con fechas de pago.</li>
                    </ul>
                    <p style="margin-top: 15px; color: #380F17;"><strong>Implicaci√≥n:</strong> La planificaci√≥n debe ajustarse din√°micamente seg√∫n d√≠a/hora, no usar promedios generales.</p>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">2. Impacto de Variables Externas</h4>
                <div class="info-box">
                    <ul>
                        <li><strong>Clima:</strong> D√≠as lluviosos incrementan demanda de platos calientes (Ranga Ranga, Sajta) en 15%, mientras reducen platos fr√≠os.</li>
                        <li><strong>Eventos Locales:</strong> Festivales aumentan demanda general 31%, pero desbalancean la mezcla de productos (turistas prefieren platos tradicionales).</li>
                        <li><strong>Promociones 2x1:</strong> Incrementan volumen 42% pero reducen margen. Importante planificar inventario extra estos d√≠as.</li>
                        <li><strong>Feriados:</strong> Demanda err√°tica - algunos feriados +50%, otros -30% (familias viajan fuera de la ciudad).</li>
                    </ul>
                    <p style="margin-top: 15px; color: #380F17;"><strong>Implicaci√≥n:</strong> Variables contextuales son tan importantes como variables temporales para predicciones precisas.</p>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">3. An√°lisis de Platos Individuales</h4>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>Ranga Ranga (32% de ventas)</strong>
                        Plato estrella, demanda estable. Predictibilidad alta (R¬≤=0.91)
                    </div>
                    <div class="feature-item">
                        <strong>Saice Tarije√±o (26% de ventas)</strong>
                        Preferido en almuerzos tard√≠os. Pico: 15:00-17:00
                    </div>
                    <div class="feature-item">
                        <strong>Sajta de Pollo (18% de ventas)</strong>
                        Mayor demanda en d√≠as fr√≠os/lluviosos (+28%)
                    </div>
                    <div class="feature-item">
                        <strong>Chancho a la Cruz (12% de ventas)</strong>
                        Favorito de fines de semana (+45% s√°bados)
                    </div>
                    <div class="feature-item">
                        <strong>Picante de Lengua (7% de ventas)</strong>
                        Nicho espec√≠fico, baja variabilidad diaria
                    </div>
                    <div class="feature-item">
                        <strong>Chicharr√≥n (5% de ventas)</strong>
                        Acompa√±amiento popular, demanda correlacionada con eventos
                    </div>
                </div>

                <div class="section-divider"></div>

                <h3>üí° Insights Accionables para el Negocio</h3>
                <div class="recommendations">
                    <li><strong>Optimizaci√≥n de Men√∫:</strong> Considerar expandir Ranga Ranga y Saice (alta demanda + alta predictibilidad) y evaluar rentabilidad de Chicharr√≥n (baja rotaci√≥n).</li>
                    <li><strong>Estrategia de Precios:</strong> Implementar precio din√°mico: +10% en horarios peak (19-21h viernes-domingo), -15% en horas valle (15-17h lunes-jueves).</li>
                    <li><strong>Gesti√≥n de Proveedores:</strong> Negociar entregas diferenciadas: mayor volumen lunes-mi√©rcoles (para preparar fin de semana), menor jueves-viernes.</li>
                    <li><strong>Marketing Dirigido:</strong> Promociones de d√≠as d√©biles (martes-mi√©rcoles) en platos con ingredientes perecederos sobrantes.</li>
                    <li><strong>Capacidad Operativa:</strong> Reforzar personal de cocina 18:00-22:00 viernes-domingo (reducir tiempos de espera en peak hours).</li>
                </div>

                <div class="section-divider"></div>

                <h3>üìä Plan de Implementaci√≥n Ejecutivo (90 D√≠as)</h3>
                
                <div class="info-box">
                    <h4>Semanas 1-2: Preparaci√≥n y Lanzamiento</h4>
                    <ul>
                        <li><strong>Objetivo:</strong> Sistema operativo con equipo capacitado</li>
                        <li><strong>Entregables:</strong> Software instalado, 5 personas entrenadas, primer predicci√≥n ejecutada</li>
                        <li><strong>KPI:</strong> 100% del personal clave aprobando evaluaci√≥n de uso del sistema</li>
                        <li><strong>Responsable:</strong> Gerente General + Consultor ML</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h4>Semanas 3-6: Prueba Piloto Controlada</h4>
                    <ul>
                        <li><strong>Objetivo:</strong> Validar precisi√≥n con los 3 platos principales (Ranga Ranga, Saice, Sajta)</li>
                        <li><strong>Entregables:</strong> 28 d√≠as de datos comparativos, reporte de ajustes necesarios</li>
                        <li><strong>KPI:</strong> Error promedio < 3 porciones/plato, reducci√≥n desperdicio > 20%</li>
                        <li><strong>Responsable:</strong> Jefe de Cocina + Encargado de Compras</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h4>Semanas 7-10: Despliegue Completo</h4>
                    <ul>
                        <li><strong>Objetivo:</strong> Todos los platos gestionados por el sistema predictivo</li>
                        <li><strong>Entregables:</strong> Sistema manual desactivado, integraci√≥n POS completa</li>
                        <li><strong>KPI:</strong> 95% de decisiones de compra basadas en predicciones ML</li>
                        <li><strong>Responsable:</strong> Gerente de Operaciones</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h4>Semanas 11-13: Evaluaci√≥n y Optimizaci√≥n</h4>
                    <ul>
                        <li><strong>Objetivo:</strong> Medir ROI real y ajustar modelo con datos de producci√≥n</li>
                        <li><strong>Entregables:</strong> Reporte financiero de impacto, modelo reentrenado v2.0</li>
                        <li><strong>KPI:</strong> ROI real > 2000%, satisfacci√≥n del equipo > 80%</li>
                        <li><strong>Responsable:</strong> Gerente General + Contador</li>
                    </ul>
                </div>

                <div class="section-divider"></div>

                <h3>üéì Aprendizajes del Proceso de Modelado</h3>
                <div class="recommendations">
                    <li><strong>Feature Engineering fue crucial:</strong> Variables derivadas (franjas horarias, estacionalidad c√≠clica) mejoraron R¬≤ de 0.78 a 0.85.</li>
                    <li><strong>Regularizaci√≥n previno overfitting:</strong> Ridge con Œ±=10 balance√≥ perfectamente bias-variance tradeoff.</li>
                    <li><strong>Transformaci√≥n polin√≥mica captur√≥ interacciones:</strong> Grado 2 fue √≥ptimo - grado 3 caus√≥ overfitting (R¬≤ train=0.94, test=0.84).</li>
                    <li><strong>Validaci√≥n cruzada confirm√≥ estabilidad:</strong> Baja varianza entre folds (¬±0.005) indica modelo robusto.</li>
                    <li><strong>MAPE m√°s √∫til que MAE:</strong> Error relativo (12.5%) m√°s interpretable para el negocio que error absoluto (2.34 porciones).</li>
                </div>

                <div class="section-divider"></div>

                <h3>üîÆ Proyecciones a Futuro (Roadmap 12 meses)</h3>
                <div class="impact-section">
                    <div class="impact-card">
                        <h3>Meses 4-6: Expansi√≥n Funcional</h3>
                        <p>‚Ä¢ Predicci√≥n de ingredientes individuales<br>
                        ‚Ä¢ Sistema de alertas inteligentes<br>
                        ‚Ä¢ Optimizaci√≥n din√°mica de precios</p>
                    </div>
                    <div class="impact-card">
                        <h3>Meses 7-9: Integraci√≥n Avanzada</h3>
                        <p>‚Ä¢ Predicci√≥n de necesidades de personal<br>
                        ‚Ä¢ App m√≥vil para gerencia<br>
                        ‚Ä¢ Dashboard analytics en tiempo real</p>
                    </div>
                    <div class="impact-card">
                        <h3>Meses 10-12: Inteligencia Competitiva</h3>
                        <p>‚Ä¢ An√°lisis de competencia con web scraping<br>
                        ‚Ä¢ Sentiment analysis de reviews<br>
                        ‚Ä¢ Recomendaciones autom√°ticas de men√∫</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 6: DOCUMENTACI√ìN -->
        <div id="documentacion" class="tab-content">
            <div class="card">
                <h2>Documentaci√≥n T√©cnica Completa</h2>

                <div class="alert alert-info">
                    <strong>üìö Prop√≥sito:</strong> Esta documentaci√≥n proporciona informaci√≥n t√©cnica detallada para desarrolladores, cient√≠ficos de datos y personal t√©cnico responsable del mantenimiento del sistema.
                </div>

                <h3>üìã Descripci√≥n General del Sistema</h3>
                <p>El Sistema Predictivo de Demanda es una soluci√≥n de Machine Learning end-to-end que utiliza regresi√≥n polin√≥mica de grado 3 con regularizaci√≥n Ridge (Œ±=200.0) para predecir la cantidad de porciones de cada plato que el Restaurante Sabor Chapaco vender√° en un momento espec√≠fico. El sistema procesa variables temporales, contextuales y categ√≥ricas mediante feature engineering avanzado y genera predicciones con un R¬≤ Score del 76.23% y un error medio de ¬±8.69 porciones.</p>

                <div class="section-divider"></div>

                <h3>üèóÔ∏è Arquitectura del Sistema</h3>
                <div class="info-box">
                    <h4>Componentes Principales</h4>
                    <ul>
                        <li><strong>Backend:</strong> Flask 2.3+ (Python 3.9+) - API RESTful para servir predicciones</li>
                        <li><strong>Frontend:</strong> HTML5 + CSS3 + Vanilla JavaScript - Interfaz web responsiva</li>
                        <li><strong>Modelo ML:</strong> Scikit-learn 1.3+ - Regresi√≥n Polin√≥mica + Ridge</li>
                        <li><strong>Persistencia:</strong> Joblib/Pickle - Serializaci√≥n de modelos entrenados</li>
                        <li><strong>Procesamiento:</strong> Pandas 2.0+ + NumPy 1.24+ - Manipulaci√≥n de datos</li>
                    </ul>
                </div>

                <div class="chart-placeholder">
                    üìê Diagrama de Arquitectura:<br>
                    [Frontend HTML] ‚ÜîÔ∏è [API Flask] ‚ÜîÔ∏è [Pipeline ML] ‚ÜîÔ∏è [Modelos .pkl]<br>
                    ‚Üì<br>
                    [Feature Engineering] ‚Üí [Scaling] ‚Üí [Polynomial Transform] ‚Üí [Predicci√≥n]
                </div>

                <div class="section-divider"></div>

                <h3>ü§ñ Modelos de Machine Learning Evaluados</h3>
                
                <h4 style="color: #8F0B13; margin-top: 20px;">Pipeline de Experimentaci√≥n</h4>
                <div class="recommendations">
                    <li><strong>Modelo 1 - Regresi√≥n Lineal M√∫ltiple (Baseline):</strong>
                        <br>‚Ä¢ Algoritmo: LinearRegression() de scikit-learn
                        <br>‚Ä¢ Features: 19 variables originales
                        <br>‚Ä¢ M√©tricas: R¬≤ = 0.7823, MAE = 3.45, RMSE = 4.21
                        <br>‚Ä¢ Conclusi√≥n: Baseline s√≥lido pero insuficiente para capturar relaciones no-lineales
                    </li>
                    <li><strong>Modelo 2 - Ridge Regression (L2 Regularization):</strong>
                        <br>‚Ä¢ Algoritmo: Ridge(alpha=1.0)
                        <br>‚Ä¢ Features: 19 variables + normalizaci√≥n
                        <br>‚Ä¢ M√©tricas: R¬≤ = 0.8156, MAE = 2.89, RMSE = 3.67
                        <br>‚Ä¢ Conclusi√≥n: Mejora significativa (+4.3% R¬≤) al controlar multicolinealidad
                    </li>
                    <li><strong>Modelo 3 - Lasso Regression (L1 Regularization):</strong>
                        <br>‚Ä¢ Algoritmo: Lasso(alpha=0.5)
                        <br>‚Ä¢ Features: 19 variables ‚Üí 14 seleccionadas autom√°ticamente
                        <br>‚Ä¢ M√©tricas: R¬≤ = 0.7945, MAE = 3.12, RMSE = 3.89
                        <br>‚Ä¢ Conclusi√≥n: Selecci√≥n de features √∫til pero loss de informaci√≥n cr√≠tica
                    </li>
                    <li><strong>Modelo 4 - Polynomial Regression Degree 2 + Ridge ‚úÖ (SELECCIONADO):</strong>
                        <br>‚Ä¢ Algoritmo: Pipeline(PolynomialFeatures(degree=2), Ridge(alpha=10.0))
                        <br>‚Ä¢ Features: 19 variables ‚Üí 276 features polin√≥micas
                        <br>‚Ä¢ M√©tricas: R¬≤ = 0.8542, MAE = 2.34, RMSE = 3.12, MAPE = 12.5%
                        <br>‚Ä¢ Conclusi√≥n: Balance √≥ptimo - captura interacciones sin overfitting
                        <br>‚Ä¢ Hyperparameters: alpha=10.0 (GridSearchCV en [0.1, 1, 10, 100])
                    </li>
                    <li><strong>Modelo 5 - Polynomial Regression Degree 3 (Descartado):</strong>
                        <br>‚Ä¢ Algoritmo: Pipeline(PolynomialFeatures(degree=3), Ridge(alpha=50.0))
                        <br>‚Ä¢ Features: 19 variables ‚Üí 2,024 features polin√≥micas
                        <br>‚Ä¢ M√©tricas: R¬≤ Train = 0.9421, R¬≤ Test = 0.8398, MAE = 2.56
                        <br>‚Ä¢ Conclusi√≥n: Overfitting evidente - gap de 10.2% entre train/test
                    </li>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Justificaci√≥n del Modelo Final</h4>
                <div class="info-box">
                    <p><strong>¬øPor qu√© Polynomial Degree 3 + Ridge?</strong></p>
                    <ul>
                        <li><strong>Captura de Patrones Complejos:</strong> Los t√©rminos c√∫bicos modelan mejor las interacciones entre variables temporales y contextuales</li>
                        <li><strong>Control de Overfitting:</strong> Ridge con Œ±=200.0 mantiene la complejidad bajo control pese a las 2,024 features polin√≥micas</li>
                        <li><strong>Balance Precisi√≥n-Generalizaci√≥n:</strong> R¬≤ de 76.23% con validaci√≥n cruzada estable (¬±0.89%)</li>
                        <li><strong>Error Interpretable:</strong> MAE de 8.69 porciones permite planificar m√°rgenes de seguridad realistas</li>
                        <li><strong>Validaci√≥n Pr√°ctica:</strong> MAPE del 19.52% es aceptable para decisiones operativas diarias</li>
                    </ul>
                    <p style="margin-top: 15px; color: #380F17;">La combinaci√≥n de mayor capacidad expresiva (grado 3) con fuerte regularizaci√≥n (Œ±=200.0) resulta en un modelo robusto y pr√°ctico para el negocio.</p>
                </div>

                <div class="section-divider"></div>

                <h3>üîß Feature Engineering Detallado</h3>
                <p>El sistema transforma 8 variables de entrada en 24 features engineered antes de la expansi√≥n polin√≥mica:</p>

                <h4 style="color: #8F0B13; margin-top: 20px;">Variables Temporales (6 features)</h4>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>hora_num</strong>
                        Hora en formato 24h (15-23, 0)
                    </div>
                    <div class="feature-item">
                        <strong>minuto</strong>
                        Minutos (0 - simplificaci√≥n actual)
                    </div>
                    <div class="feature-item">
                        <strong>mes</strong>
                        Mes num√©rico (1-12)
                    </div>
                    <div class="feature-item">
                        <strong>dia</strong>
                        D√≠a del mes (1-31)
                    </div>
                    <div class="feature-item">
                        <strong>dia_semana_num</strong>
                        0=Lunes ... 6=Domingo
                    </div>
                    <div class="feature-item">
                        <strong>trimestre</strong>
                        Trimestre fiscal (1-4)
                    </div>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Variables Binarias de Franjas (3 features)</h4>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>es_tarde</strong>
                        1 si hora ‚àà [15-18], else 0
                    </div>
                    <div class="feature-item">
                        <strong>es_cena</strong>
                        1 si hora ‚àà [19-22], else 0
                    </div>
                    <div class="feature-item">
                        <strong>es_noche</strong>
                        1 si hora ‚àà [23, 0], else 0
                    </div>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Variables C√≠clicas Trigonom√©tricas (4 features)</h4>
                <div class="info-box">
                    <p><strong>Prop√≥sito:</strong> Capturar periodicidad sin discontinuidades (ej: diciembre est√° cerca de enero, no lejos)</p>
                    <ul>
                        <li><strong>mes_sin:</strong> sin(2œÄ √ó mes / 12) - Componente sinusoidal mensual</li>
                        <li><strong>mes_cos:</strong> cos(2œÄ √ó mes / 12) - Componente cosinusoidal mensual</li>
                        <li><strong>hora_sin:</strong> sin(2œÄ √ó hora / 24) - Componente sinusoidal horaria</li>
                        <li><strong>hora_cos:</strong> cos(2œÄ √ó hora / 24) - Componente cosinusoidal horaria</li>
                    </ul>
                    <p style="margin-top: 10px; color: #380F17;"><strong>Ventaja:</strong> El modelo aprende que 23:00 y 00:00 est√°n cerca (sin/cos similares) vs. representaci√≥n num√©rica donde 23 y 0 parecen lejanos.</p>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Variables Contextuales (3 features)</h4>
                <div class="feature-grid">
                    <div class="feature-item">
                        <strong>temporada_turistica</strong>
                        1 si mes ‚àà Mayo-Octubre, else 0
                    </div>
                    <div class="feature-item">
                        <strong>es_fin_semana</strong>
                        1 si d√≠a ‚àà Vie-Dom, else 0
                    </div>
                    <div class="feature-item">
                        <strong>es_fin_mes</strong>
                        1 si d√≠a > 25, else 0
                    </div>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Variables Categ√≥ricas Codificadas (4 features)</h4>
                <div class="recommendations">
                    <li><strong>plato_encoded:</strong> Label Encoding (0-6) - 7 platos diferentes</li>
                    <li><strong>condicion_climatica_encoded:</strong> {Soleado: 0, Nublado: 1, Lluvioso: 2}</li>
                    <li><strong>evento_local_encoded:</strong> {Ninguno: 0, Fiesta: 1, Festival: 2, Feriado: 3}</li>
                    <li><strong>tipo_promocion_encoded:</strong> {Ninguna: 0, Descuento: 1, 2x1: 2, Menu del Dia: 3}</li>
                </ul>
                <p style="margin-top: 10px; color: #380F17;"><strong>Nota:</strong> Se usa Label Encoding en vez de One-Hot por la naturaleza ordinal impl√≠cita y para reducir dimensionalidad antes de expansi√≥n polin√≥mica.</p>
                </div>

                <div class="section-divider"></div>

                <h3>üíæ Archivos del Sistema y Estructura de Proyecto</h3>
                <div class="info-box">
                    <h4>Estructura de Directorios</h4>
                    <pre style="background: #252B2B; color: #EFDFC5; padding: 15px; border-radius: 8px; overflow-x: auto;">
                        sistema_predictivo_sabor_chapaco/
                        ‚îÇ
                        ‚îú‚îÄ‚îÄ static/                                     # Assets est√°ticos
                        ‚îÇ   ‚îú‚îÄ‚îÄ img/                                   # Im√°genes del proyecto
                        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SaborChapaco.jpeg                  # Logo del restaurante
                        ‚îÇ   ‚îî‚îÄ‚îÄ graficos/                              # Visualizaciones ML
                        ‚îÇ       ‚îú‚îÄ‚îÄ 01_pred_vs_real.png                # Predicci√≥n vs Real
                        ‚îÇ       ‚îî‚îÄ‚îÄ ...                                # Otras visualizaciones
                        ‚îÇ
                        ‚îú‚îÄ‚îÄ app.py                                     # Backend Flask principal
                        ‚îú‚îÄ‚îÄ index.html                                 # Interfaz web completa
                        ‚îú‚îÄ‚îÄ requerimientos.txt                         # Dependencias Python
                        ‚îÇ
                        ‚îú‚îÄ‚îÄ modelo_final_sabor_chapaco.pkl            # Modelo ML entrenado (23.4 MB)
                        ‚îú‚îÄ‚îÄ scaler_sabor_chapaco.pkl                  # StandardScaler fitted (2.1 KB)
                        ‚îú‚îÄ‚îÄ label_encoders_sabor_chapaco.pkl          # Dict LabelEncoders (1.8 KB)
                        ‚îú‚îÄ‚îÄ polynomial_features.pkl                    # PolynomialFeatures(degree=2) (1.2 KB)
                        ‚îú‚îÄ‚îÄ model_info.pkl                            # Metadata y m√©tricas (4.3 KB)
                        ‚îÇ
                        ‚îî‚îÄ‚îÄ README.md                                 # Documentaci√≥n del proyecto

                        URLs para archivos est√°ticos:
                        ‚îú‚îÄ‚îÄ Logo: /static/img/SaborChapaco.jpeg
                        ‚îî‚îÄ‚îÄ Gr√°ficos: /static/graficos/*.png

                        Referencia en HTML:
                        img src="/static/img/SaborChapaco.jpeg"
                        img src="/static/graficos/01_pred_vs_real.png"

                    </pre>
                </div>

                <div class="section-divider"></div>

                <h3>‚öôÔ∏è Instrucciones de Instalaci√≥n y Despliegue</h3>
                
                <h4 style="color: #8F0B13; margin-top: 20px;">Prerrequisitos</h4>
                <div class="recommendations">
                    <li><strong>Python 3.9+</strong> (recomendado: 3.10 o 3.11)</li>
                    <li><strong>pip</strong> actualizado (pip install --upgrade pip)</li>
                    <li><strong>Entorno virtual</strong> (venv o conda)</li>
                    <li><strong>8GB RAM</strong> m√≠nimo (16GB recomendado para reentrenamiento)</li>
                    <li><strong>Navegador moderno</strong> (Chrome 90+, Firefox 88+, Safari 14+)</li>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Paso 1: Clonar e Instalar</h4>
                <div class="info-box">
                    <pre style="background: #252B2B; color: #EFDFC5; padding: 15px; border-radius: 8px; overflow-x: auto;">
                        # 1. Crear y activar entorno virtual (Windows PowerShell)
                        python -m venv .venv
                        Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
                        .\.venv\Scripts\Activate.ps1

                        # 2. Instalar dependencias
                        pip install -r requerimientos.txt

                        # 3. Verificar estructura de archivos est√°ticos
                        mkdir -p static/img static/graficos
                        mv SaborChapaco.jpeg static/img/
                        mv *.png static/graficos/

                        # 4. Verificar modelos
                        python -c "import joblib; print('‚úì' if all(joblib.load(f) for f in [
                            'modelo_final_sabor_chapaco.pkl',
                            'scaler_sabor_chapaco.pkl',
                            'label_encoders_sabor_chapaco.pkl',
                            'model_info.pkl'
                        ]) else '‚úó Error al cargar modelos')"
                    </pre>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Paso 2: Verificar Modelos</h4>
                <div class="info-box">
                    <pre style="background: #252B2B; color: #EFDFC5; padding: 15px; border-radius: 8px; overflow-x: auto;">
                        # Verificar que todos los archivos .pkl existan
                        python -c "import os; print('OK' if all(os.path.exists(f) for f in [
                            'modelo_final_sabor_chapaco.pkl',
                            'scaler_sabor_chapaco.pkl',
                            'label_encoders_sabor_chapaco.pkl',
                            'polynomial_features.pkl',
                            'model_info.pkl'
                        ]) else 'FALTA ARCHIVOS')"

                        # Probar carga de modelos
                        python prediccion.py --test
                    </pre>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Paso 3: Iniciar Servidor</h4>
                <div class="info-box">
                    <pre style="background: #252B2B; color: #EFDFC5; padding: 15px; border-radius: 8px; overflow-x: auto;">
                        # Modo desarrollo (con hot-reload)
                        python app.py

                        # Modo producci√≥n (con gunicorn)
                        gunicorn -w 4 -b 0.0.0.0:5000 app:app

                        # Verificar salud del servidor
                        curl http://localhost:5000/api/health
                    </pre>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Paso 4: Acceder a la Interfaz</h4>
                <p>Abrir navegador en: <code>http://localhost:5000</code></p>

                <div class="section-divider"></div>

                <h3>üîÑ API Endpoints Documentados</h3>
                
                <div class="recommendations">
                    <li><strong>POST /api/predict</strong> - Generar predicci√≥n
                        <br><em>Body:</em> { "plato", "fecha", "hora", "dia_semana", "clima", "evento", "promocion", "fin_semana" }
                        <br><em>Response:</em> { "success", "prediction", "prediction_rounded", "stock_min", "stock_max", "margen_seguridad", "confianza" }
                    </li>
                    <li><strong>GET /api/model-info</strong> - Informaci√≥n del modelo
                        <br><em>Response:</em> { "model_name", "metrics": {"R2", "MAE", "RMSE", "MAPE"}, "feature_count", "trained_date" }
                    </li>
                    <li><strong>GET /api/health</strong> - Estado del servidor
                        <br><em>Response:</em> { "status": "healthy", "model_loaded": true, "version": "2.1.0", "horario": "15:00 - 00:00" }
                    </li>
                    <li><strong>GET /api/platos</strong> - Lista de platos disponibles
                        <br><em>Response:</em> { "success": true, "platos": [...] }
                    </li>
                    <li><strong>GET /api/statistics</strong> - Estad√≠sticas del sistema
                        <br><em>Response:</em> { "model_accuracy", "average_error", "model_version", "horario_operacion" }
                    </li>
                </div>

                <div class="section-divider"></div>

                <h3>‚ö†Ô∏è Limitaciones Identificadas del Sistema</h3>

                <div class="limitation-card">
                    <h4>üéØ Limitaci√≥n 1: Dependencia de Datos Hist√≥ricos</h4>
                    <p><strong>Descripci√≥n:</strong> El modelo est√° entrenado con datos de enero 2023 - diciembre 2024. Eventos completamente nuevos (ej: pandemia, apertura de competidor directo al lado) no est√°n en el historial.</p>
                    <p><strong>Impacto:</strong> Predicciones pueden ser inexactas (¬±30-50%) en situaciones sin precedente.</p>
                    <p><strong>Mitigaci√≥n:</strong> 
                        <br>‚Ä¢ Reentrenamiento mensual con datos recientes
                        <br>‚Ä¢ Sistema de alertas para detectar anomal√≠as (predicci√≥n vs. real > 40%)
                        <br>‚Ä¢ Bot√≥n de "override manual" para ajustes humanos en casos excepcionales
                    </p>
                </div>

                <div class="limitation-card">
                    <h4>üìÖ Limitaci√≥n 2: Granularidad Temporal Limitada</h4>
                    <p><strong>Descripci√≥n:</strong> Predicciones son por hora completa, no por minutos. No captura rush de 19:15-19:45 espec√≠ficamente.</p>
                    <p><strong>Impacto:</strong> Micro-picos dentro de una hora pueden causar faltantes temporales.</p>
                    <p><strong>Mitigaci√≥n:</strong>
                        <br>‚Ä¢ Implementar margen de seguridad mayor (+20%) en horas peak
                        <br>‚Ä¢ Versi√≥n futura: predicci√≥n cada 15 minutos requiere m√°s datos
                    </p>
                </div>

                <div class="limitation-card">
                    <h4>üåê Limitaci√≥n 3: Variables Externas No Capturadas</h4>
                    <p><strong>Descripci√≥n:</strong> Factores como construcciones cercanas, tr√°fico inusual, publicidad viral en redes sociales, no est√°n en el modelo.</p>
                    <p><strong>Impacto:</strong> Demanda puede variar ¬±15-25% por factores no considerados.</p>
                    <p><strong>Mitigaci√≥n:</strong>
                        <br>‚Ä¢ Expansi√≥n futura: scraping de redes sociales para sentiment analysis
                        <br>‚Ä¢ Integraci√≥n con Google Maps API para datos de tr√°fico
                        <br>‚Ä¢ Feedback semanal del personal sobre factores externos observados
                    </p>
                </div>

                <div class="limitation-card">
                    <h4>üîÑ Limitaci√≥n 4: Cold Start Problem - Platos Nuevos</h4>
                    <p><strong>Descripci√≥n:</strong> Si se introduce un plato nuevo al men√∫, no hay datos hist√≥ricos para predecir su demanda.</p>
                    <p><strong>Impacto:</strong> Primeras 2-4 semanas de un plato nuevo requieren estimaci√≥n manual.</p>
                    <p><strong>Mitigaci√≥n:</strong>
                        <br>‚Ä¢ Usar predicci√≥n de plato similar como proxy (ej: nuevo guiso ‚Üí usar datos de Ranga Ranga)
                        <br>‚Ä¢ Periodo de aprendizaje de 30 d√≠as con sobre-stock intencional (+40%)
                        <br>‚Ä¢ Modelo de transferencia: aprender de categor√≠as ("platos picantes", "platos de cerdo")
                    </p>
                </div>

                <div class="limitation-card">
                    <h4>üíª Limitaci√≥n 5: Requiere Conexi√≥n y Mantenimiento</h4>
                    <p><strong>Descripci√≥n:</strong> Sistema cloud-based requiere internet. Ca√≠da del servidor = p√©rdida temporal de predicciones.</p>
                    <p><strong>Impacto:</strong> Downtime puede requerir volver a estimaci√≥n manual.</p>
                    <p><strong>Mitigaci√≥n:</strong>
                        <br>‚Ä¢ Cach√© local de √∫ltimas predicciones (v√°lidas por 24h)
                        <br>‚Ä¢ Backup de hoja de c√°lculo con promedios hist√≥ricos
                        <br>‚Ä¢ SLA de 99.5% uptime con monitoreo 24/7
                    </p>
                </div>

                <div class="limitation-card">
                    <h4>üìä Limitaci√≥n 6: Precisi√≥n Variable por Plato</h4>
                    <p><strong>Descripci√≥n:</strong> R¬≤=0.85 es promedio. Platos de nicho (Chicharr√≥n) tienen R¬≤=0.68, mientras estrella (Ranga Ranga) tiene R¬≤=0.91.</p>
                    <p><strong>Impacto:</strong> Confianza debe ajustarse por plato espec√≠fico.</p>
                    <p><strong>Mitigaci√≥n:</strong>
                        <br>‚Ä¢ Mostrar nivel de confianza individualizado por plato
                        <br>‚Ä¢ Margen de seguridad adaptativo: ¬±10% para Ranga Ranga, ¬±25% para Chicharr√≥n
                        <br>‚Ä¢ Modelos especializados por categor√≠a de plato en versi√≥n futura
                    </p>
                </div>

                <div class="section-divider"></div>

                <h3>üöÄ Mejoras Futuras Identificadas</h3>

                <h4 style="color: #8F0B13; margin-top: 20px;">Corto Plazo (3-6 meses)</h4>
                <div class="recommendations">
                    <li><strong>Predicci√≥n Multi-Output:</strong> Predecir demanda de todos los platos simult√°neamente (un solo llamado API en vez de 7)</li>
                    <li><strong>Intervalos de Confianza:</strong> Mostrar rango probabil√≠stico (ej: "80% seguro de 45-52 porciones") en vez de punto √∫nico</li>
                    <li><strong>Explicabilidad (SHAP Values):</strong> Mostrar qu√© factores impulsaron cada predicci√≥n espec√≠fica ("Demanda alta por: fin_semana=1, promocion=2x1")</li>
                    <li><strong>Alertas Proactivas:</strong> Email/SMS autom√°ticos si predicci√≥n > 30% sobre promedio ("Preparar stock extra de...")</li>
                    <li><strong>Dashboard Analytics:</strong> Visualizaciones en tiempo real de accuracy, tendencias, comparativa mensual</li>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Mediano Plazo (6-12 meses)</h4>
                <div class="recommendations">
                    <li><strong>Deep Learning (LSTM/GRU):</strong> Redes neuronales recurrentes para capturar dependencias temporales de largo plazo</li>
                    <li><strong>Ensemble Methods:</strong> Combinar Random Forest + XGBoost + Polinomial para reducir error a MAE < 2.0</li>
                    <li><strong>Predicci√≥n de Ingredientes:</strong> Expandir a nivel granular (kg de carne, docenas de huevos, litros de leche)</li>
                    <li><strong>Optimizaci√≥n de Precios Din√°mica:</strong> Sugerir ajustes de precio basados en elasticidad de demanda predicha</li>
                    <li><strong>A/B Testing Automatizado:</strong> Sistema que prueba variantes de estrategias y mide resultados objetivamente</li>
                </div>

                <h4 style="color: #8F0B13; margin-top: 20px;">Largo Plazo (12-24 meses)</h4>
                <div class="recommendations">
                    <li><strong>Computer Vision:</strong> C√°maras que detectan ocupaci√≥n del restaurante en tiempo real para ajustar predicciones din√°micamente</li>
                    <li><strong>NLP y Sentiment Analysis:</strong> Analizar reviews online y redes sociales para anticipar cambios de preferencias</li>
                    <li><strong>Reinforcement Learning:</strong> Agente que aprende estrategias √≥ptimas de inventario mediante trial-error simulado</li>
                    <li><strong>Predicci√≥n de Personal:</strong> Cu√°ntos meseros/cocineros necesitar seg√∫n demanda y tiempos de servicio esperados</li>
                    <li><strong>Sistema Multi-Restaurante:</strong> Si Sabor Chapaco expande sucursales, modelo que aprende de todas las locaciones</li>
                </div>

                <div class="section-divider"></div>

                

                <h3>üìñ Referencias y Recursos</h3>
                <div class="recommendations">
                    <li><strong>Documentaci√≥n Scikit-learn:</strong> https://scikit-learn.org/stable/modules/linear_model.html</li>
                    <li><strong>Tutorial Feature Engineering:</strong> https://machinelearningmastery.com/discover-feature-engineering-how-to-engineer-features-and-how-to-get-good-at-it/</li>
                    <li><strong>Polynomial Regression Explained:</strong> https://towardsdatascience.com/polynomial-regression-bbe8b9d97491</li>
                    <li><strong>Demand Forecasting in Restaurants:</strong> Journal of Hospitality & Tourism Research, Vol. 45(2), 2021</li>
                    <li><strong>Time Series Cross-Validation:</strong> https://robjhyndman.com/hyndsight/tscv/</li>
                    <li><strong>Ejemplos de Uso de Assets Est√°ticos:</strong>
                        <br>‚Ä¢ Logo: <code>&lt;img src="/static/img/SaborChapaco.jpeg" alt="Logo"&gt;</code>
                        <br>‚Ä¢ Gr√°fico: <code>&lt;img src="/static/graficos/01_pred_vs_real.png" alt="Predicci√≥n vs Real"&gt;</code>
                        <br>‚Ä¢ CSS: <code>background-image: url('/static/img/SaborChapaco.jpeg');</code>
                    </li>
                </div>

            </div>
        </div>

    </div>

    <!-- Lightbox modal HTML -->
    <div id="imgModal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <div style="position: relative;">
                <div id="modalClose" class="modal-close" title="Cerrar">√ó</div>
                <img id="modalImg" class="modal-image" src="" alt="">
            </div>
            <div id="modalCaption" class="modal-caption"></div>
        </div>
    </div>

    <script>
        function switchTab(tabId) {
            // Ocultar todos los contenidos
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            // Mostrar el contenido seleccionado
            document.getElementById(tabId).classList.add('active');

            // Activar el bot√≥n correspondiente
            const activeButton = Array.from(buttons).find(btn => {
                const btnText = btn.textContent.toLowerCase();
                return btnText.includes(tabId);
            });
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }

        // ============================================================================
        // SISTEMA DE ALERTAS (JS)
        // ============================================================================

        async function cargarAlertas() {
            try {
                const response = await fetch('/api/alertas/ultimas');
                const data = await response.json();

                if (!data.success) {
                    mostrarErrorAlertas('No se pudieron cargar las alertas');
                    return;
                }

                // Actualizar resumen
                document.getElementById('totalAlertas').textContent = data.total_alertas || 0;
                document.getElementById('alertasCriticas').textContent = data.alertas_criticas || 0;

                // Contar por tipo
                let sobreventa = 0, merma = 0;
                if (data.alertas) {
                    data.alertas.forEach(a => {
                        if (a.tipo === 'sobreventa') sobreventa++;
                        if (a.tipo === 'merma_alta') merma++;
                    });
                }
                document.getElementById('alertasSobreventa').textContent = sobreventa;
                document.getElementById('alertasMerma').textContent = merma;

                // Mostrar alertas
                mostrarAlertas(data.alertas || []);

            } catch (error) {
                console.error('Error cargando alertas:', error);
                mostrarErrorAlertas('Error de conexi√≥n con el servidor');
            }
        }

        function mostrarAlertas(alertas) {
            const container = document.getElementById('alertasContainer');

            if (!alertas || alertas.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">
                        <h3>‚úÖ No hay alertas activas</h3>
                        <p>El sistema est√° funcionando correctamente. Todas las predicciones est√°n dentro de los rangos normales.</p>
                    </div>
                `;
                return;
            }

            // Ordenar por nivel (cr√≠ticas primero)
            const ordenNivel = { 'CRITICO': 0, 'ALTO': 1, 'MEDIO': 2, 'BAJO': 3, 'INFO': 4 };
            alertas.sort((a, b) => ordenNivel[a.nivel] - ordenNivel[b.nivel]);

            container.innerHTML = alertas.map(alerta => `
                <div class="alerta-card ${alerta.nivel}">
                    <div class="alerta-header">
                        <span class="alerta-emoji">${alerta.nivel_emoji}</span>
                        <span class="alerta-nivel">${alerta.nivel}</span>
                    </div>
                    <div class="alerta-tipo">${alerta.tipo.replace('_', ' ')}</div>
                    <div class="alerta-mensaje">${alerta.mensaje}</div>
                    ${alerta.plato ? `<div class="alerta-plato">üçΩÔ∏è ${alerta.plato}</div>` : ''}
                    <div class="alerta-plato">üìÖ ${formatearFecha(alerta.fecha)}</div>
                    
                    ${alerta.valor_actual !== null && alerta.valor_esperado !== null ? `
                        <div class="alerta-valores">
                            <div class="alerta-valor">
                                <span class="alerta-valor-label">Actual</span>
                                <span class="alerta-valor-numero">${Math.round(alerta.valor_actual)}</span>
                            </div>
                            <div class="alerta-valor">
                                <span class="alerta-valor-label">Esperado</span>
                                <span class="alerta-valor-numero">${Math.round(alerta.valor_esperado)}</span>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${alerta.recomendacion ? `
                        <div class="alerta-recomendacion">
                            <strong>üí° Recomendaci√≥n:</strong><br>
                            ${alerta.recomendacion}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function mostrarErrorAlertas(mensaje) {
            const container = document.getElementById('alertasContainer');
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #8F0B13;">
                    <h3>‚ö†Ô∏è ${mensaje}</h3>
                    <button class="btn-refresh" onclick="cargarAlertas()">Reintentar</button>
                </div>
            `;
        }

        function formatearFecha(fechaStr) {
            const fecha = new Date(fechaStr);
            const dias = ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'];
            return `${dias[fecha.getDay()]} ${fecha.getDate()}/${fecha.getMonth()+1}/${fecha.getFullYear()}`;
        }

        document.getElementById('predictionForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            // Preparar datos del formulario
            const form = event.target;
            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => { data[key] = value; });

            // Mostrar estado de carga
            const resultBox = document.getElementById('predictionResult');
            const predictionValueEl = document.getElementById('predictionValue');
            const margenEl = document.getElementById('margen');
            const stockMinEl = document.getElementById('stockMin');
            const stockMaxEl = document.getElementById('stockMax');
            const confianzaEl = document.getElementById('confianza');

            predictionValueEl.textContent = '‚è≥';
            margenEl.textContent = '...';
            stockMinEl.textContent = '...';
            stockMaxEl.textContent = '...';
            resultBox.classList.add('show');

            try {
                // Intentar primero con ruta relativa, luego con localhost expl√≠cito
                let apiUrl = '/api/predict';
                
                const resp = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                // Si la respuesta no es OK, intentar leer el error
                if (!resp.ok) {
                    const errorText = await resp.text();
                    console.error('Error del servidor:', errorText);
                    
                    try {
                        const errorJson = JSON.parse(errorText);
                        predictionValueEl.textContent = '‚ùå';
                        alert('Error al obtener predicci√≥n: ' + (errorJson.error || errorJson.message || resp.statusText));
                    } catch {
                        predictionValueEl.textContent = '‚ùå';
                        alert('Error del servidor (c√≥digo ' + resp.status + '): ' + errorText);
                    }
                    return;
                }

                const json = await resp.json();

                if (!json.success) {
                    predictionValueEl.textContent = '‚ùå';
                    alert('Error en la predicci√≥n: ' + (json.error || json.message || 'Error desconocido'));
                    return;
                }

                // Mostrar resultado
                const predictedValue = json.prediction_rounded ?? Math.round(json.prediction ?? 0);
                const margenSeguridad = json.margen_seguridad ?? 0;
                const stockMin = json.stock_min ?? 0;
                const stockMax = json.stock_max ?? 0;
                const confianza = json.confianza ?? 85;

                predictionValueEl.textContent = predictedValue;
                margenEl.textContent = margenSeguridad;
                stockMinEl.textContent = stockMin;
                stockMaxEl.textContent = stockMax;
                confianzaEl.textContent = confianza;

            } catch (err) {
                predictionValueEl.textContent = '‚ùå';
                console.error('Error al llamar al backend:', err);
                alert('No se pudo conectar al servidor. Aseg√∫rate de que la API est√© corriendo en http://localhost:5000');
            }
        });

        // Establecer fecha de hoy por defecto
        document.addEventListener('DOMContentLoaded', function() {
            const fechaInput = document.querySelector('input[name="fecha"]');
            if (fechaInput) {
                const today = new Date().toISOString().split('T')[0];
                fechaInput.value = today;
            }
            // Inicializar lightbox para im√°genes con clase viz-img
            const modal = document.getElementById('imgModal');
            const modalImg = document.getElementById('modalImg');
            const modalCaption = document.getElementById('modalCaption');
            const modalClose = document.getElementById('modalClose');

            function openModal(src, caption) {
                modalImg.src = src;
                modalImg.alt = caption || '';
                modalCaption.textContent = caption || '';
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }

            function closeModal() {
                modal.style.display = 'none';
                modalImg.src = '';
                modalCaption.textContent = '';
                document.body.style.overflow = '';
            }

            // Cerrar al hacer click en la X o fuera del contenido
            modalClose.addEventListener('click', closeModal);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeModal();
            });

            // Agregar listeners a im√°genes
            document.querySelectorAll('.viz-img').forEach(img => {
                img.style.cursor = 'zoom-in';
                img.addEventListener('click', function() {
                    const src = this.getAttribute('src');
                    const caption = this.getAttribute('data-caption') || this.alt || '';
                    openModal(src, caption);
                });
                // fallback: mostrar imagen en nueva pesta√±a con Ctrl+click
                img.addEventListener('auxclick', function(e){ if(e.button===1){ window.open(this.src, '_blank'); } });
            });

            // Cargar alertas al inicio
            if (typeof cargarAlertas === 'function') cargarAlertas();
        });
    </script>
</body>
</html> 